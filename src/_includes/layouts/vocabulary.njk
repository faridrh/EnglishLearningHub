---
layout: layouts/base.njk
---

<div class="container">
  <article class="vocabulary">
    <header class="page-header">
      <h1 class="page-title">{{ title }}</h1>
      <div class="level-badge level-{{ level | lower }}">{{ level }}</div>
    </header>

    <div class="page-content">
      {{ content | safe }}
      
      {% if wordlist %}
      <!-- Flashcard Section -->
      <div class="flashcard-section">
        <h2>Practice with Flashcards</h2>
        <p class="flashcard-intro">Tap the card to reveal the translation. Track your progress below!</p>
        
        <div class="flashcard-wrapper">
          <!-- Progress Indicator -->
          <div class="fc-progress-container">
            <div id="fc-progress-dots" class="fc-progress-dots"></div>
            <span id="fc-progress-text" class="fc-progress-text">1 / {{ wordlist | length }}</span>
          </div>

          <!-- Flashcard -->
          <div class="fc-card-container" onclick="fcFlipCard()">
            <div id="fc-card-inner" class="fc-card-inner">
              <div class="fc-card-front">
                <span class="fc-emoji" id="fc-front-emoji">üìö</span>
                <p id="fc-term" class="fc-term">Loading...</p>
                <p class="fc-hint">Click to flip</p>
              </div>
              <div class="fc-card-back">
                <p id="fc-definition" class="fc-definition">Loading...</p>
                <span class="fc-emoji" id="fc-back-emoji">‚ú®</span>
                <p class="fc-hint-back">Click to flip back</p>
              </div>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="fc-nav-buttons">
            <button onclick="fcPrevCard()" class="fc-btn fc-btn-secondary">
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/></svg>
              Previous
            </button>
            <button onclick="fcNextCard()" class="fc-btn fc-btn-primary">
              Next
              <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
            </button>
          </div>

          <!-- Score Buttons -->
          <div class="fc-score-buttons">
            <button onclick="fcMarkKnown()" class="fc-btn fc-btn-known">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/></svg>
              I know this
            </button>
            <button onclick="fcMarkLearning()" class="fc-btn fc-btn-learning">
              <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"/></svg>
              Still learning
            </button>
          </div>

          <!-- Stats -->
          <div class="fc-stats">
            <div class="fc-stat fc-stat-known">
              <p class="fc-stat-number" id="fc-known-count">0</p>
              <p class="fc-stat-label">Known</p>
            </div>
            <div class="fc-stat fc-stat-learning">
              <p class="fc-stat-number" id="fc-learning-count">0</p>
              <p class="fc-stat-label">Learning</p>
            </div>
            <div class="fc-stat fc-stat-remaining">
              <p class="fc-stat-number" id="fc-remaining-count">{{ wordlist | length }}</p>
              <p class="fc-stat-label">Remaining</p>
            </div>
          </div>

          <!-- Completion Message -->
          <div id="fc-completion" class="fc-completion" style="display: none;">
            <span class="fc-completion-emoji">üéâ</span>
            <h3>Awesome job!</h3>
            <p>You've reviewed all the flashcards!</p>
            <button onclick="fcResetDeck()" class="fc-btn fc-btn-primary">Start Over</button>
          </div>
        </div>
      </div>

      <div class="vocabulary-list">
        <h2>Word List</h2>
        <div class="vocabulary-grid">
          {% for word in wordlist %}
          <div class="vocabulary-card">
            <h3 class="word">{{ word.term }}</h3>
            <p class="pronunciation">{{ word.pronunciation }}</p>
            <p class="part-of-speech">{{ word.partOfSpeech }}</p>
            <p class="definition">{{ word.definition }}</p>
            {% if word.azerbaijani %}
            <p class="azerbaijani-translation">{{ word.azerbaijani }}</p>
            {% endif %}
            {% if word.example %}
            <p class="example"><em>"{{ word.example }}"</em></p>
            {% endif %}
            {% if word.exampleAz %}
            <p class="example-az"><em>"{{ word.exampleAz }}"</em></p>
            {% endif %}
            {% if word.synonyms %}
            <p class="synonyms"><strong>Synonyms:</strong> {{ word.synonyms | join(", ") }}</p>
            {% endif %}
            {% if word.category %}
            <p class="category"><small><strong>Category:</strong> {{ word.category }}</small></p>
            {% endif %}
          </div>
          {% endfor %}
        </div>
      </div>
      
      {% if currentPage and totalPages %}
      <div class="pagination">
        <div class="pagination-info">
          <p>Page {{ currentPage }} of {{ totalPages }}</p>
        </div>
        <div class="pagination-nav">
          {% if currentPage > 1 %}
            <a href="/vocabulary/{{ level | lower }}/page-{{ currentPage - 1 }}/" class="pagination-btn prev">‚Üê Previous</a>
          {% endif %}
          
          <div class="pagination-numbers">
            {% for i in range(1, totalPages + 1) %}
              {% if i == currentPage %}
                <span class="pagination-current">{{ i }}</span>
              {% else %}
                <a href="/vocabulary/{{ level | lower }}/page-{{ i }}/" class="pagination-number">{{ i }}</a>
              {% endif %}
            {% endfor %}
          </div>
          
          {% if currentPage < totalPages %}
            <a href="/vocabulary/{{ level | lower }}/page-{{ currentPage + 1 }}/" class="pagination-btn next">Next ‚Üí</a>
          {% endif %}
        </div>
      </div>
      {% endif %}
      {% endif %}
    </div>
  </article>
</div>

<style>
/* Vocabulary-specific styles */
.vocabulary-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
  gap: 20px;
  margin: 20px 0;
}

.vocabulary-card {
  background: white;
  border: 1px solid #e0e6ed;
  border-radius: 8px;
  padding: 20px;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.vocabulary-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.vocabulary-card .word {
  color: #2c5aa0;
  margin: 0 0 8px 0;
  font-size: 1.4em;
  font-weight: bold;
}

.vocabulary-card .pronunciation {
  color: #666;
  font-style: italic;
  margin: 0 0 8px 0;
  font-size: 0.9em;
}

.vocabulary-card .part-of-speech {
  color: #28a745;
  font-weight: bold;
  margin: 0 0 10px 0;
  font-size: 0.85em;
  text-transform: uppercase;
}

.vocabulary-card .definition {
  color: #333;
  margin: 0 0 10px 0;
  line-height: 1.5;
}

.vocabulary-card .azerbaijani-translation {
  color: #000;
  margin: 0 0 10px 0;
  padding: 8px 12px;
  background: #fffbf0;
  border-radius: 4px;
  font-weight: 500;
}

.vocabulary-card .example {
  color: #666;
  margin: 0 0 8px 0;
  background: #f8f9fa;
  padding: 8px 12px;
  border-left: 3px solid #007bff;
  border-radius: 4px;
}

.vocabulary-card .example-az {
  color: #000;
  margin: 0 0 8px 0;
  padding: 8px 12px;
  font-style: italic;
}

.vocabulary-card .synonyms {
  color: #666;
  margin: 0 0 8px 0;
  font-size: 0.9em;
}

.vocabulary-card .category {
  color: #6c757d;
  margin: 0;
  text-align: right;
}

/* Pagination styles */
.pagination {
  margin: 40px 0 20px 0;
  padding: 20px;
  background: #f8f9fa;
  border-radius: 8px;
  border: 1px solid #e9ecef;
}

.pagination-info {
  text-align: center;
  margin-bottom: 20px;
}

.pagination-info p {
  margin: 0;
  color: #6c757d;
  font-weight: bold;
}

.pagination-nav {
  display: flex;
  justify-content: space-between;
  align-items: center;
  flex-wrap: wrap;
  gap: 10px;
}

.pagination-btn {
  background: #007bff;
  color: white;
  padding: 10px 20px;
  border-radius: 5px;
  text-decoration: none;
  font-weight: bold;
  transition: background-color 0.3s ease;
}

.pagination-btn:hover {
  background: #0056b3;
  text-decoration: none;
  color: white;
}

.pagination-numbers {
  display: flex;
  gap: 8px;
  flex-wrap: wrap;
}

.pagination-number {
  display: inline-block;
  padding: 8px 12px;
  background: white;
  border: 1px solid #dee2e6;
  border-radius: 4px;
  text-decoration: none;
  color: #007bff;
  font-weight: bold;
  transition: all 0.3s ease;
}

.pagination-number:hover {
  background: #007bff;
  color: white;
  text-decoration: none;
}

.pagination-current {
  display: inline-block;
  padding: 8px 12px;
  background: #007bff;
  color: white;
  border-radius: 4px;
  font-weight: bold;
}

/* Mobile responsiveness */
@media (max-width: 768px) {
  .vocabulary-grid {
    grid-template-columns: 1fr;
  }
  
  .pagination-nav {
    flex-direction: column;
    text-align: center;
  }
  
  .pagination-numbers {
    justify-content: center;
  }
}

/* Flashcard Styles */
.flashcard-section {
  margin: 30px 0;
  padding: 30px;
  background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 50%, #f0fdfa 100%);
  border-radius: 16px;
  text-align: center;
}

.flashcard-section h2 {
  color: #1e293b;
  margin-bottom: 8px;
}

.flashcard-intro {
  color: #64748b;
  margin-bottom: 24px;
}

.flashcard-wrapper {
  max-width: 500px;
  margin: 0 auto;
}

.fc-progress-container {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 12px;
  margin-bottom: 24px;
}

.fc-progress-dots {
  display: flex;
  gap: 6px;
  flex-wrap: wrap;
  justify-content: center;
}

.fc-progress-dot {
  width: 10px;
  height: 10px;
  border-radius: 50%;
  background: #cbd5e1;
  transition: all 0.3s ease;
}

.fc-progress-dot.active {
  transform: scale(1.3);
  background: #06b6d4;
}

.fc-progress-dot.known {
  background: #10b981;
}

.fc-progress-dot.learning {
  background: #f43f5e;
}

.fc-progress-text {
  color: #475569;
  font-weight: 600;
}

.fc-card-container {
  perspective: 1000px;
  width: 100%;
  height: 280px;
  cursor: pointer;
  margin-bottom: 20px;
}

.fc-card-inner {
  position: relative;
  width: 100%;
  height: 100%;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  transform-style: preserve-3d;
}

.fc-card-inner.flipped {
  transform: rotateY(180deg);
}

.fc-card-front, .fc-card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  border-radius: 16px;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 24px;
  box-sizing: border-box;
}

.fc-card-front {
  background: white;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  border: 2px solid #e0f2fe;
}

.fc-card-back {
  background: linear-gradient(135deg, #06b6d4, #14b8a6);
  box-shadow: 0 10px 40px rgba(6,182,212,0.3);
  transform: rotateY(180deg);
}

.fc-emoji {
  font-size: 48px;
  margin-bottom: 16px;
}

.fc-term {
  font-size: 28px;
  font-weight: 600;
  color: #1e293b;
  margin: 0 0 16px 0;
  text-align: center;
}

.fc-definition {
  font-size: 28px;
  font-weight: 600;
  color: white;
  margin: 0 0 16px 0;
  text-align: center;
}

.fc-hint {
  color: #94a3b8;
  font-size: 14px;
  margin: 0;
}

.fc-hint-back {
  color: rgba(255,255,255,0.7);
  font-size: 14px;
  margin: 0;
}

.fc-nav-buttons {
  display: flex;
  justify-content: center;
  gap: 16px;
  margin-bottom: 16px;
}

.fc-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 12px 24px;
  border: none;
  border-radius: 50px;
  font-weight: 500;
  font-size: 15px;
  cursor: pointer;
  transition: all 0.2s ease;
}

.fc-btn:hover {
  transform: translateY(-2px);
}

.fc-btn:active {
  transform: translateY(0);
}

.fc-btn-primary {
  background: linear-gradient(135deg, #06b6d4, #14b8a6);
  color: white;
  box-shadow: 0 4px 15px rgba(6,182,212,0.3);
}

.fc-btn-secondary {
  background: white;
  color: #475569;
  border: 1px solid #e2e8f0;
  box-shadow: 0 2px 8px rgba(0,0,0,0.08);
}

.fc-score-buttons {
  display: flex;
  justify-content: center;
  gap: 12px;
  margin-bottom: 24px;
}

.fc-btn-known {
  background: #10b981;
  color: white;
  font-size: 14px;
  padding: 10px 20px;
}

.fc-btn-learning {
  background: #f43f5e;
  color: white;
  font-size: 14px;
  padding: 10px 20px;
}

.fc-stats {
  display: flex;
  justify-content: center;
  gap: 20px;
}

.fc-stat {
  background: rgba(255,255,255,0.7);
  backdrop-filter: blur(10px);
  border-radius: 16px;
  padding: 16px 24px;
  text-align: center;
}

.fc-stat-number {
  font-size: 24px;
  font-weight: 700;
  margin: 0 0 4px 0;
}

.fc-stat-label {
  font-size: 14px;
  color: #64748b;
  margin: 0;
}

.fc-stat-known .fc-stat-number { color: #10b981; }
.fc-stat-learning .fc-stat-number { color: #f43f5e; }
.fc-stat-remaining .fc-stat-number { color: #475569; }

.fc-completion {
  background: white;
  border-radius: 16px;
  padding: 32px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.1);
  margin-top: 24px;
}

.fc-completion-emoji {
  font-size: 60px;
  display: block;
  margin-bottom: 16px;
}

.fc-completion h3 {
  color: #1e293b;
  margin: 0 0 8px 0;
}

.fc-completion p {
  color: #64748b;
  margin: 0 0 20px 0;
}

@media (max-width: 480px) {
  .fc-card-container {
    height: 240px;
  }
  
  .fc-term, .fc-definition {
    font-size: 22px;
  }
  
  .fc-nav-buttons, .fc-score-buttons {
    flex-wrap: wrap;
  }
  
  .fc-stats {
    flex-wrap: wrap;
  }
  
  .fc-stat {
    padding: 12px 16px;
  }
}
</style>

{% if wordlist %}
<script>
(function() {
  // Flashcard data from the wordlist
  const flashcards = [
    {% for word in wordlist %}
    { 
      term: "{{ word.term | replace('"', '\\"') }}", 
      definition: "{{ word.azerbaijani | replace('"', '\\"') }}",
      emoji: "üìö",
      backEmoji: "‚ú®"
    }{% if not loop.last %},{% endif %}
    {% endfor %}
  ];

  // Emoji mapping for categories
  const emojiMap = {
    "Greetings": "üëã",
    "Politeness": "üôè",
    "Basic Responses": "üí¨",
    "Food & Drink": "üçΩÔ∏è",
    "Places": "üè†",
    "Relationships": "üë´",
    "default": "üìö"
  };

  // State
  let currentIndex = 0;
  let isFlipped = false;
  let knownCards = new Set();
  let learningCards = new Set();

  function init() {
    renderProgressDots();
    updateCard();
    updateStats();
  }

  function renderProgressDots() {
    const container = document.getElementById('fc-progress-dots');
    if (!container) return;
    container.innerHTML = flashcards.map((_, i) => 
      `<div class="fc-progress-dot ${i === 0 ? 'active' : ''}" data-index="${i}"></div>`
    ).join('');
  }

  function updateProgressDots() {
    const dots = document.querySelectorAll('.fc-progress-dot');
    dots.forEach((dot, i) => {
      dot.classList.remove('active', 'known', 'learning');
      
      if (knownCards.has(i)) {
        dot.classList.add('known');
      } else if (learningCards.has(i)) {
        dot.classList.add('learning');
      }
      
      if (i === currentIndex) {
        dot.classList.add('active');
      }
    });
  }

  window.fcFlipCard = function() {
    const cardInner = document.getElementById('fc-card-inner');
    isFlipped = !isFlipped;
    cardInner.classList.toggle('flipped', isFlipped);
  };

  function updateCard() {
    const card = flashcards[currentIndex];
    document.getElementById('fc-term').textContent = card.term;
    document.getElementById('fc-definition').textContent = card.definition;
    document.getElementById('fc-front-emoji').textContent = card.emoji;
    document.getElementById('fc-back-emoji').textContent = card.backEmoji;
    document.getElementById('fc-progress-text').textContent = `${currentIndex + 1} / ${flashcards.length}`;
    
    // Reset flip state
    if (isFlipped) {
      isFlipped = false;
      document.getElementById('fc-card-inner').classList.remove('flipped');
    }
    
    updateProgressDots();
  }

  window.fcNextCard = function() {
    if (currentIndex < flashcards.length - 1) {
      currentIndex++;
      updateCard();
    } else {
      checkCompletion();
    }
  };

  window.fcPrevCard = function() {
    if (currentIndex > 0) {
      currentIndex--;
      updateCard();
    }
  };

  window.fcMarkKnown = function() {
    knownCards.add(currentIndex);
    learningCards.delete(currentIndex);
    updateStats();
    updateProgressDots();
    
    if (currentIndex < flashcards.length - 1) {
      setTimeout(() => { currentIndex++; updateCard(); }, 300);
    } else {
      checkCompletion();
    }
  };

  window.fcMarkLearning = function() {
    learningCards.add(currentIndex);
    knownCards.delete(currentIndex);
    updateStats();
    updateProgressDots();
    
    if (currentIndex < flashcards.length - 1) {
      setTimeout(() => { currentIndex++; updateCard(); }, 300);
    } else {
      checkCompletion();
    }
  };

  function updateStats() {
    document.getElementById('fc-known-count').textContent = knownCards.size;
    document.getElementById('fc-learning-count').textContent = learningCards.size;
    document.getElementById('fc-remaining-count').textContent = flashcards.length - knownCards.size - learningCards.size;
  }

  function checkCompletion() {
    if (knownCards.size + learningCards.size === flashcards.length) {
      document.getElementById('fc-completion').style.display = 'block';
    }
  }

  window.fcResetDeck = function() {
    currentIndex = 0;
    knownCards.clear();
    learningCards.clear();
    document.getElementById('fc-completion').style.display = 'none';
    updateCard();
    updateStats();
    renderProgressDots();
  };

  // Initialize when DOM is ready
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', init);
  } else {
    init();
  }
})();
</script>
{% endif %}
